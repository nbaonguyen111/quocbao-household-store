{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/src/app/gio-hang/addtocart.js"],"sourcesContent":["\r\nimport { doc, getDoc, setDoc } from \"firebase/firestore\";\r\nimport { db } from \"@/firebase/firebase\";\r\n\r\nexport const addToCart = async (userId, product) => {\r\n  try {\r\n    const productRef = doc(db, \"carts\", userId, \"items\", product.id);\r\n    const snapshot = await getDoc(productRef);\r\n\r\n    if (snapshot.exists()) {\r\n      const currentQty = snapshot.data().quantity || 1;\r\n      await setDoc(productRef, {\r\n        ...product,\r\n        quantity: currentQty + 1,\r\n      });\r\n    } else {\r\n      await setDoc(productRef, {\r\n        ...product,\r\n        quantity: 1,\r\n      });\r\n    }\r\n\r\n    console.log(\"✅ Đã thêm sản phẩm vào giỏ\");\r\n  } catch (error) {\r\n    console.error(\"❌ Lỗi khi thêm giỏ hàng:\", error);\r\n  }\r\n};\r\n"],"names":[],"mappings":";;;AACA;AAAA;AACA;;;AAEO,MAAM,YAAY,OAAO,QAAQ;IACtC,IAAI;QACF,MAAM,aAAa,CAAA,GAAA,iKAAA,CAAA,MAAG,AAAD,EAAE,2HAAA,CAAA,KAAE,EAAE,SAAS,QAAQ,SAAS,QAAQ,EAAE;QAC/D,MAAM,WAAW,MAAM,CAAA,GAAA,iKAAA,CAAA,SAAM,AAAD,EAAE;QAE9B,IAAI,SAAS,MAAM,IAAI;YACrB,MAAM,aAAa,SAAS,IAAI,GAAG,QAAQ,IAAI;YAC/C,MAAM,CAAA,GAAA,iKAAA,CAAA,SAAM,AAAD,EAAE,YAAY;gBACvB,GAAG,OAAO;gBACV,UAAU,aAAa;YACzB;QACF,OAAO;YACL,MAAM,CAAA,GAAA,iKAAA,CAAA,SAAM,AAAD,EAAE,YAAY;gBACvB,GAAG,OAAO;gBACV,UAAU;YACZ;QACF;QAEA,QAAQ,GAAG,CAAC;IACd,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;IAC5C;AACF","debugId":null}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/src/app/page.jsx"],"sourcesContent":["\"use client\";\r\nimport React, { useEffect, useState, useCallback } from \"react\";\r\nimport { db } from \"@/firebase/firebase\";\r\nimport { collection, getDocs, query, limit, where } from \"firebase/firestore\";\r\nimport { createFetch } from \"next/dist/client/components/router-reducer/fetch-server-response\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { addToCart } from \"./gio-hang/addtocart\";\r\nimport { getAuth } from \"@firebase/auth\";\r\n\r\n\r\n\r\nexport default function TrangChu() {\r\n  const [featuredProducts, setFeaturedProducts] = useState([]);\r\n  const [allProducts, setAllProducts] = useState([]);\r\n  const [userId,setUserId] = useState(null);\r\n  const router = useRouter();\r\n  const smallBanners = [\r\n    \"/images/bannernho1.png\",\r\n    \"/images/bannernho2.png\",\r\n    \"/images/bannernho3.png\",\r\n    \"/images/bannernho4.png\",\r\n    \"/images/bannernho5.png\",\r\n    \"/images/bannernho6.png\"\r\n  ];\r\n  // index của banner đầu tiên trên màn hình (hiển thị 2 banner / lần)\r\n  const [smallBannerIdx, setSmallBannerIdx] = useState(0);\r\n\r\n  /* Hàm chuyển slide */\r\n  const nextSlide = useCallback(() => {\r\n    setSmallBannerIdx((prev) => (prev + 2) % smallBanners.length);\r\n  }, []);\r\n\r\n  const prevSlide = () => {\r\n    // + smallBanners.length để tránh số âm rồi mod\r\n    setSmallBannerIdx((prev) => (prev - 2 + smallBanners.length) % smallBanners.length);\r\n  };\r\n\r\n  /* Tự động chuyển mỗi 3 s */\r\n  useEffect(() => {\r\n    const timer = setInterval(nextSlide, 3000);\r\n    return () => clearInterval(timer);\r\n  }, [nextSlide]);\r\nuseEffect(() => {\r\n  const auth = getAuth();\r\n  const unsubscribe = onAuthStateChanged(auth, (user) => {\r\n    if (user) {\r\n      setUserId(user.uid);\r\n    } else {\r\n      setUserId(null); // hoặc điều hướng sang /login nếu cần\r\n    }\r\n  });\r\n\r\n  return () => unsubscribe();\r\n})\r\nconst handleAddToCart = async (product) => {\r\n  if (!userId) {\r\n    toast.error(\"Bạn cần đăng nhập để thêm giỏ hàng\");\r\n    return;\r\n  }\r\n\r\n  await addToCart(userId, product);\r\n  toast.success(\"Đã thêm vào giỏ hàng!\");\r\n};\r\n  const fetchFeaturedProducts = async () => {\r\n    try {\r\n      const snapshot = await getDocs(query(collection(db, \"products\"), where(\"featured\", \"==\", true), limit(4)));\r\n      const data = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n\r\n      const productsWithRating = await Promise.all(\r\n        data.map(async (product) => {\r\n          const reviewsSnapshot = await getDocs(\r\n            query(collection(db, \"reviews\"), where(\"productId\", \"==\", product.id))\r\n          );\r\n\r\n          const ratings = reviewsSnapshot.docs.map(doc => doc.data().rating);\r\n          const avgRating =\r\n            ratings.length > 0\r\n              ? (ratings.reduce((a, b) => a + b, 0) / ratings.length).toFixed(1)\r\n              : \"Chưa có\";\r\n\r\n          return {\r\n            ...product,\r\n            rating: avgRating,\r\n          };\r\n        })\r\n      );\r\n\r\n      setFeaturedProducts(productsWithRating);\r\n    } catch (error) {\r\n      console.log(\"Lỗi khi lấy sản phẩm nổi bật\", error);\r\n    }\r\n  };\r\n  const getAllProducts = async () => {\r\n    try {\r\n      const snapshot = await getDocs(collection(db, \"products\"));\r\n      const data = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n      setAllProducts(data);\r\n    } catch (error) {\r\n      console.log(\"Lỗi khi lấy sản phẩm\", error);\r\n    }\r\n  };\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    getAllProducts();\r\n    fetchFeaturedProducts();\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <section className=\"banner w-full mb-4 flex justify-center\">\r\n        <img\r\n          src=\"/images/bannerlonpng.png\"\r\n          alt=\"Banner\"\r\n          className=\"w-full max-h-72 object-contain rounded-lg shadow\"\r\n        />\r\n      </section>\r\n\r\n      <section className=\"danh-muc bg-white py-4 rounded-lg shadow mb-6\">\r\n        <div className=\"flex justify-around items-end\">\r\n          {/* Máy lạnh */}\r\n          <button className=\"flex flex-col items-center px-4 py-2 bg-gray-100 rounded-lg hover:bg-blue-100 transition cursor-pointer border border-transparent hover:border-blue-400 focus:outline-none\">\r\n            <div className=\"relative\">\r\n              <img src=\"/images/maylanh.png\" alt=\"Máy lạnh\" className=\"h-12 w-auto mb-1\" />\r\n              <span className=\"absolute top-0 right-0 bg-red-200 text-red-600 text-xs font-bold px-2 rounded\">HOT</span>\r\n            </div>\r\n            <span className=\"mt-1 text-sm font-medium\">Máy lạnh</span>\r\n          </button>\r\n          {/* Quạt điều hòa */}\r\n          <button className=\"flex flex-col items-center px-4 py-2 bg-gray-100 rounded-lg hover:bg-blue-100 transition cursor-pointer border border-transparent hover:border-blue-400 focus:outline-none\">\r\n            <div className=\"relative\">\r\n              <img src=\"/images/maygiat.png\" alt=\"Quạt điều hòa\" className=\"h-12 w-auto mb-1\" />\r\n              <span className=\"absolute top-0 right-0 bg-red-200 text-red-600 text-xs font-bold px-2 rounded\">HOT</span>\r\n            </div>\r\n            <span className=\"mt-1 text-sm font-medium\">Máy giặt</span>\r\n          </button>\r\n          {/* Máy giặt */}\r\n          <button className=\"flex flex-col items-center px-4 py-2 bg-gray-100 rounded-lg hover:bg-blue-100 transition cursor-pointer border border-transparent hover:border-blue-400 focus:outline-none\">\r\n            <img src=\"/images/tulanh.png\" alt=\"Máy giặt\" className=\"h-12 w-auto mb-2\" />\r\n            <span className=\"mt-1 text-sm font-medium\">Tủ lạnh</span>\r\n          </button>\r\n          {/* Máy lọc nước */}\r\n          <button className=\"flex flex-col items-center px-4 py-2 bg-gray-100 rounded-lg hover:bg-blue-100 transition cursor-pointer border border-transparent hover:border-blue-400 focus:outline-none\">\r\n            <img src=\"/images/mayquat.png\" alt=\"Máy lọc nước\" className=\"h-12 w-auto mb-2\" />\r\n            <span className=\"mt-1 text-sm font-medium\">Máy quạt</span>\r\n          </button>\r\n          {/* Tủ đông mát */}\r\n          <button className=\"flex flex-col items-center px-4 py-2 bg-gray-100 rounded-lg hover:bg-blue-100 transition cursor-pointer border border-transparent hover:border-blue-400 focus:outline-none\">\r\n            <img src=\"/images/tivi.png\" alt=\"Tủ đông mát\" className=\"h-12 w-auto mb-2\" />\r\n            <span className=\"mt-1 text-sm font-medium\">Tivi</span>\r\n          </button>\r\n        </div>\r\n      </section>\r\n\r\n      <section className=\"san-pham-noi-bat\">\r\n        <h2>Sản phẩm nổi bật</h2>\r\n        <div className=\"flex flex-wrap gap-4 justify-center\">\r\n          {featuredProducts.length === 0 ? (\r\n            <div>Đang tải...</div>\r\n          ) : (\r\n            featuredProducts.map((sp) => (\r\n              <div key={sp.id} className=\"bg-white rounded-lg shadow p-3 w-60 flex flex-col items-center\">\r\n                <img src={`images/${sp.imageUrl}`} alt={sp.name} className=\"w-full h-28 object-contain mb-2\" />\r\n                <div className=\"font-semibold mb-1\"><a href={`product/${sp.id}`}>{sp.name}</a></div>\r\n                <div className=\"text-red-600 text-lg font-bold mb-1\">\r\n                  {sp.price?.toLocaleString()}₫\r\n                </div>\r\n                <div className=\"flex items-center text-yellow-500 text-sm\">\r\n                  <span>★</span>\r\n                  <span className=\"ml-1\">{sp.rating}</span>\r\n                </div>\r\n              </div>\r\n            ))\r\n          )}\r\n        </div>\r\n      </section>\r\n      <br />\r\n      {/* Banner nhỏ chuyển động */}\r\n      {/* ----------------- BANNER NHỎ ĐẸP & CÂN ĐỐI ----------------- */}\r\n      <div className=\"relative w-full max-w-6xl mx-auto mb-6 px-4\">\r\n        {/* 2 banner chia đều 50% */}\r\n        <div className=\"grid grid-cols-2 gap-4\">\r\n          {[0, 1].map((offset) => {\r\n            const idx = (smallBannerIdx + offset) % smallBanners.length;\r\n            return (\r\n              <img\r\n                key={idx}\r\n                src={smallBanners[idx]}\r\n                alt={`Banner ${idx + 1}`}\r\n                className=\"w-full h-[110px] object-cover rounded-lg shadow-md\"\r\n              />\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n      <br />\r\n      <section className=\"all-products\">\r\n        <h2>Tất Cả Sản Phẩm</h2>\r\n        <div className=\"flex flex-wrap gap-4 justify-center\">\r\n          {allProducts.length === 0 ? (\r\n            <div>Đang tải...</div>\r\n          ) : (\r\n            allProducts.map((sp) => (\r\n              <div key={sp.id} className=\"bg-white rounded-lg shadow p-3 w-60 flex flex-col items-center\">\r\n                <img src={`images/${sp.imageUrl}`} alt={sp.name} className=\"w-full h-28 object-contain mb-2\" />\r\n                <div className=\"font-semibold mb-1\"><a href={`product/${sp.id}`}>{sp.name}</a></div>\r\n                <div className=\"text-red-600 text-lg font-bold mb-1\">\r\n                  {sp.price?.toLocaleString()}₫\r\n                </div>\r\n                 <div className=\"flex items-center text-yellow-500 text-sm\">\r\n                  <span>Thêm vào giỏ hàng</span>\r\n                  \r\n                </div> \r\n              </div>\r\n            ))\r\n          )}\r\n        </div>\r\n      </section>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 581, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/node_modules/next/src/client/components/app-router-headers.ts"],"sourcesContent":["export const RSC_HEADER = 'RSC' as const\nexport const ACTION_HEADER = 'Next-Action' as const\n// TODO: Instead of sending the full router state, we only need to send the\n// segment path. Saves bytes. Then we could also use this field for segment\n// prefetches, which also need to specify a particular segment.\nexport const NEXT_ROUTER_STATE_TREE_HEADER = 'Next-Router-State-Tree' as const\nexport const NEXT_ROUTER_PREFETCH_HEADER = 'Next-Router-Prefetch' as const\n// This contains the path to the segment being prefetched.\n// TODO: If we change Next-Router-State-Tree to be a segment path, we can use\n// that instead. Then Next-Router-Prefetch and Next-Router-Segment-Prefetch can\n// be merged into a single enum.\nexport const NEXT_ROUTER_SEGMENT_PREFETCH_HEADER =\n  'Next-Router-Segment-Prefetch' as const\nexport const NEXT_HMR_REFRESH_HEADER = 'Next-HMR-Refresh' as const\nexport const NEXT_HMR_REFRESH_HASH_COOKIE = '__next_hmr_refresh_hash__' as const\nexport const NEXT_URL = 'Next-Url' as const\nexport const RSC_CONTENT_TYPE_HEADER = 'text/x-component' as const\n\nexport const FLIGHT_HEADERS = [\n  RSC_HEADER,\n  NEXT_ROUTER_STATE_TREE_HEADER,\n  NEXT_ROUTER_PREFETCH_HEADER,\n  NEXT_HMR_REFRESH_HEADER,\n  NEXT_ROUTER_SEGMENT_PREFETCH_HEADER,\n] as const\n\nexport const NEXT_RSC_UNION_QUERY = '_rsc' as const\n\nexport const NEXT_ROUTER_STALE_TIME_HEADER = 'x-nextjs-stale-time' as const\nexport const NEXT_DID_POSTPONE_HEADER = 'x-nextjs-postponed' as const\nexport const NEXT_REWRITTEN_PATH_HEADER = 'x-nextjs-rewritten-path' as const\nexport const NEXT_REWRITTEN_QUERY_HEADER = 'x-nextjs-rewritten-query' as const\nexport const NEXT_IS_PRERENDER_HEADER = 'x-nextjs-prerender' as const\n"],"names":["ACTION_HEADER","FLIGHT_HEADERS","NEXT_DID_POSTPONE_HEADER","NEXT_HMR_REFRESH_HASH_COOKIE","NEXT_HMR_REFRESH_HEADER","NEXT_IS_PRERENDER_HEADER","NEXT_REWRITTEN_PATH_HEADER","NEXT_REWRITTEN_QUERY_HEADER","NEXT_ROUTER_PREFETCH_HEADER","NEXT_ROUTER_SEGMENT_PREFETCH_HEADER","NEXT_ROUTER_STALE_TIME_HEADER","NEXT_ROUTER_STATE_TREE_HEADER","NEXT_RSC_UNION_QUERY","NEXT_URL","RSC_CONTENT_TYPE_HEADER","RSC_HEADER"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;IACaA,aAAa,EAAA;eAAbA;;IAiBAC,cAAc,EAAA;eAAdA;;IAWAC,wBAAwB,EAAA;eAAxBA;;IAfAC,4BAA4B,EAAA;eAA5BA;;IADAC,uBAAuB,EAAA;eAAvBA;;IAmBAC,wBAAwB,EAAA;eAAxBA;;IAFAC,0BAA0B,EAAA;eAA1BA;;IACAC,2BAA2B,EAAA;eAA3BA;;IAzBAC,2BAA2B,EAAA;eAA3BA;;IAKAC,mCAAmC,EAAA;eAAnCA;;IAiBAC,6BAA6B,EAAA;eAA7BA;;IAvBAC,6BAA6B,EAAA;eAA7BA;;IAqBAC,oBAAoB,EAAA;eAApBA;;IAXAC,QAAQ,EAAA;eAARA;;IACAC,uBAAuB,EAAA;eAAvBA;;IAhBAC,UAAU,EAAA;eAAVA;;;AAAN,MAAMA,aAAa;AACnB,MAAMf,gBAAgB;AAItB,MAAMW,gCAAgC;AACtC,MAAMH,8BAA8B;AAKpC,MAAMC,sCACX;AACK,MAAML,0BAA0B;AAChC,MAAMD,+BAA+B;AACrC,MAAMU,WAAW;AACjB,MAAMC,0BAA0B;AAEhC,MAAMb,iBAAiB;IAC5Bc;IACAJ;IACAH;IACAJ;IACAK;CACD;AAEM,MAAMG,uBAAuB;AAE7B,MAAMF,gCAAgC;AACtC,MAAMR,2BAA2B;AACjC,MAAMI,6BAA6B;AACnC,MAAMC,8BAA8B;AACpC,MAAMF,2BAA2B","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 693, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/node_modules/next/src/client/components/router-reducer/router-reducer-types.ts"],"sourcesContent":["import type { CacheNode } from '../../../shared/lib/app-router-context.shared-runtime'\nimport type {\n  FlightRouterState,\n  FlightSegmentPath,\n} from '../../../server/app-render/types'\nimport type { FetchServerResponseResult } from './fetch-server-response'\n\nexport const ACTION_REFRESH = 'refresh'\nexport const ACTION_NAVIGATE = 'navigate'\nexport const ACTION_RESTORE = 'restore'\nexport const ACTION_SERVER_PATCH = 'server-patch'\nexport const ACTION_PREFETCH = 'prefetch'\nexport const ACTION_HMR_REFRESH = 'hmr-refresh'\nexport const ACTION_SERVER_ACTION = 'server-action'\n\nexport type RouterChangeByServerResponse = ({\n  navigatedAt,\n  previousTree,\n  serverResponse,\n}: {\n  navigatedAt: number\n  previousTree: FlightRouterState\n  serverResponse: FetchServerResponseResult\n}) => void\n\nexport interface Mutable {\n  mpaNavigation?: boolean\n  patchedTree?: FlightRouterState\n  canonicalUrl?: string\n  scrollableSegments?: FlightSegmentPath[]\n  pendingPush?: boolean\n  cache?: CacheNode\n  prefetchCache?: AppRouterState['prefetchCache']\n  hashFragment?: string\n  shouldScroll?: boolean\n  preserveCustomHistoryState?: boolean\n  onlyHashChange?: boolean\n}\n\nexport interface ServerActionMutable extends Mutable {\n  inFlightServerAction?: Promise<any> | null\n}\n\n/**\n * Refresh triggers a refresh of the full page data.\n * - fetches the Flight data and fills rsc at the root of the cache.\n * - The router state is updated at the root.\n */\nexport interface RefreshAction {\n  type: typeof ACTION_REFRESH\n  origin: Location['origin']\n}\n\nexport interface HmrRefreshAction {\n  type: typeof ACTION_HMR_REFRESH\n  origin: Location['origin']\n}\n\nexport type ServerActionDispatcher = (\n  args: Omit<\n    ServerActionAction,\n    'type' | 'mutable' | 'navigate' | 'changeByServerResponse' | 'cache'\n  >\n) => void\n\nexport interface ServerActionAction {\n  type: typeof ACTION_SERVER_ACTION\n  actionId: string\n  actionArgs: any[]\n  resolve: (value: any) => void\n  reject: (reason?: any) => void\n}\n\n/**\n * Navigate triggers a navigation to the provided url. It supports two types: `push` and `replace`.\n *\n * `navigateType`:\n * - `push` - pushes a new history entry in the browser history\n * - `replace` - replaces the current history entry in the browser history\n *\n * Navigate has multiple cache heuristics:\n * - page was prefetched\n *  - Apply router state tree from prefetch\n *  - Apply Flight data from prefetch to the cache\n *  - If Flight data is a string, it's a redirect and the state is updated to trigger a redirect\n *  - Check if hard navigation is needed\n *    - Hard navigation happens when a dynamic parameter below the common layout changed\n *    - When hard navigation is needed the cache is invalidated below the flightSegmentPath\n *    - The missing cache nodes of the page will be fetched in layout-router and trigger the SERVER_PATCH action\n *  - If hard navigation is not needed\n *    - The cache is reused\n *    - If any cache nodes are missing they'll be fetched in layout-router and trigger the SERVER_PATCH action\n * - page was not prefetched\n *  - The navigate was called from `next/router` (`router.push()` / `router.replace()`) / `next/link` without prefetched data available (e.g. the prefetch didn't come back from the server before clicking the link)\n *    - Flight data is fetched in the reducer (suspends the reducer)\n *    - Router state tree is created based on Flight data\n *    - Cache is filled based on the Flight data\n *\n * Above steps explain 3 cases:\n * - `soft` - Reuses the existing cache and fetches missing nodes in layout-router.\n * - `hard` - Creates a new cache where cache nodes are removed below the common layout and fetches missing nodes in layout-router.\n * - `optimistic` (explicit no prefetch) - Creates a new cache and kicks off the data fetch in the reducer. The data fetch is awaited in the layout-router.\n */\nexport interface NavigateAction {\n  type: typeof ACTION_NAVIGATE\n  url: URL\n  isExternalUrl: boolean\n  locationSearch: Location['search']\n  navigateType: 'push' | 'replace'\n  shouldScroll: boolean\n  allowAliasing: boolean\n}\n\n/**\n * Restore applies the provided router state.\n * - Used for `popstate` (back/forward navigation) where a known router state has to be applied.\n * - Also used when syncing the router state with `pushState`/`replaceState` calls.\n * - Router state is applied as-is from the history state, if available.\n * - If the history state does not contain the router state, the existing router state is used.\n * - If any cache node is missing it will be fetched in layout-router during rendering and the server-patch case.\n * - If existing cache nodes match these are used.\n */\nexport interface RestoreAction {\n  type: typeof ACTION_RESTORE\n  url: URL\n  tree: FlightRouterState | undefined\n}\n\n/**\n * Server-patch applies the provided Flight data to the cache and router tree.\n * - Only triggered in layout-router.\n * - Creates a new cache and router state with the Flight data applied.\n */\nexport interface ServerPatchAction {\n  type: typeof ACTION_SERVER_PATCH\n  navigatedAt: number\n  serverResponse: FetchServerResponseResult\n  previousTree: FlightRouterState\n}\n\n/**\n * PrefetchKind defines the type of prefetching that should be done.\n * - `auto` - if the page is dynamic, prefetch the page data partially, if static prefetch the page data fully.\n * - `full` - prefetch the page data fully.\n * - `temporary` - a temporary prefetch entry is added to the cache, this is used when prefetch={false} is used in next/link or when you push a route programmatically.\n */\n\nexport enum PrefetchKind {\n  AUTO = 'auto',\n  FULL = 'full',\n  TEMPORARY = 'temporary',\n}\n\n/**\n * Prefetch adds the provided FlightData to the prefetch cache\n * - Creates the router state tree based on the patch in FlightData\n * - Adds the FlightData to the prefetch cache\n * - In ACTION_NAVIGATE the prefetch cache is checked and the router state tree and FlightData are applied.\n */\nexport interface PrefetchAction {\n  type: typeof ACTION_PREFETCH\n  url: URL\n  kind: PrefetchKind\n}\n\nexport interface PushRef {\n  /**\n   * If the app-router should push a new history entry in app-router's useEffect()\n   */\n  pendingPush: boolean\n  /**\n   * Multi-page navigation through location.href.\n   */\n  mpaNavigation: boolean\n  /**\n   * Skip applying the router state to the browser history state.\n   */\n  preserveCustomHistoryState: boolean\n}\n\nexport type FocusAndScrollRef = {\n  /**\n   * If focus and scroll should be set in the layout-router's useEffect()\n   */\n  apply: boolean\n  /**\n   * The hash fragment that should be scrolled to.\n   */\n  hashFragment: string | null\n  /**\n   * The paths of the segments that should be focused.\n   */\n  segmentPaths: FlightSegmentPath[]\n  /**\n   * If only the URLs hash fragment changed\n   */\n  onlyHashChange: boolean\n}\n\nexport type PrefetchCacheEntry = {\n  treeAtTimeOfPrefetch: FlightRouterState\n  data: Promise<FetchServerResponseResult>\n  kind: PrefetchKind\n  prefetchTime: number\n  staleTime: number\n  lastUsedTime: number | null\n  key: string\n  status: PrefetchCacheEntryStatus\n  url: URL\n}\n\nexport enum PrefetchCacheEntryStatus {\n  fresh = 'fresh',\n  reusable = 'reusable',\n  expired = 'expired',\n  stale = 'stale',\n}\n\n/**\n * Handles keeping the state of app-router.\n */\nexport type AppRouterState = {\n  /**\n   * The router state, this is written into the history state in app-router using replaceState/pushState.\n   * - Has to be serializable as it is written into the history state.\n   * - Holds which segments and parallel routes are shown on the screen.\n   */\n  tree: FlightRouterState\n  /**\n   * The cache holds React nodes for every segment that is shown on screen as well as previously shown segments.\n   * It also holds in-progress data requests.\n   * Prefetched data is stored separately in `prefetchCache`, that is applied during ACTION_NAVIGATE.\n   */\n  cache: CacheNode\n  /**\n   * Cache that holds prefetched Flight responses keyed by url.\n   */\n  prefetchCache: Map<string, PrefetchCacheEntry>\n  /**\n   * Decides if the update should create a new history entry and if the navigation has to trigger a browser navigation.\n   */\n  pushRef: PushRef\n  /**\n   * Decides if the update should apply scroll and focus management.\n   */\n  focusAndScrollRef: FocusAndScrollRef\n  /**\n   * The canonical url that is pushed/replaced.\n   * - This is the url you see in the browser.\n   */\n  canonicalUrl: string\n  /**\n   * The underlying \"url\" representing the UI state, which is used for intercepting routes.\n   */\n  nextUrl: string | null\n}\n\nexport type ReadonlyReducerState = Readonly<AppRouterState>\nexport type ReducerState = Promise<AppRouterState> | AppRouterState\nexport type ReducerActions = Readonly<\n  | RefreshAction\n  | NavigateAction\n  | RestoreAction\n  | ServerPatchAction\n  | PrefetchAction\n  | HmrRefreshAction\n  | ServerActionAction\n>\n"],"names":["ACTION_HMR_REFRESH","ACTION_NAVIGATE","ACTION_PREFETCH","ACTION_REFRESH","ACTION_RESTORE","ACTION_SERVER_ACTION","ACTION_SERVER_PATCH","PrefetchCacheEntryStatus","PrefetchKind"],"mappings":";;;;;;;;;;;;;;;;;;;;;;IAYaA,kBAAkB,EAAA;eAAlBA;;IAJAC,eAAe,EAAA;eAAfA;;IAGAC,eAAe,EAAA;eAAfA;;IAJAC,cAAc,EAAA;eAAdA;;IAEAC,cAAc,EAAA;eAAdA;;IAIAC,oBAAoB,EAAA;eAApBA;;IAHAC,mBAAmB,EAAA;eAAnBA;;IAyMDC,wBAAwB,EAAA;eAAxBA;;IAhEAC,YAAY,EAAA;eAAZA;;;AA5IL,MAAML,iBAAiB;AACvB,MAAMF,kBAAkB;AACxB,MAAMG,iBAAiB;AACvB,MAAME,sBAAsB;AAC5B,MAAMJ,kBAAkB;AACxB,MAAMF,qBAAqB;AAC3B,MAAMK,uBAAuB;AAsI7B,IAAKG,eAAAA,WAAAA,GAAAA,SAAAA,YAAAA;;;;WAAAA;;AAgEL,IAAKD,2BAAAA,WAAAA,GAAAA,SAAAA,wBAAAA;;;;;WAAAA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 775, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/node_modules/%40swc/helpers/cjs/_interop_require_wildcard.cjs"],"sourcesContent":["\"use strict\";\n\nfunction _getRequireWildcardCache(nodeInterop) {\n    if (typeof WeakMap !== \"function\") return null;\n\n    var cacheBabelInterop = new WeakMap();\n    var cacheNodeInterop = new WeakMap();\n\n    return (_getRequireWildcardCache = function(nodeInterop) {\n        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n    })(nodeInterop);\n}\nfunction _interop_require_wildcard(obj, nodeInterop) {\n    if (!nodeInterop && obj && obj.__esModule) return obj;\n    if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") return { default: obj };\n\n    var cache = _getRequireWildcardCache(nodeInterop);\n\n    if (cache && cache.has(obj)) return cache.get(obj);\n\n    var newObj = { __proto__: null };\n    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n    for (var key in obj) {\n        if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n            if (desc && (desc.get || desc.set)) Object.defineProperty(newObj, key, desc);\n            else newObj[key] = obj[key];\n        }\n    }\n\n    newObj.default = obj;\n\n    if (cache) cache.set(obj, newObj);\n\n    return newObj;\n}\nexports._ = _interop_require_wildcard;\n"],"names":[],"mappings":"AAAA;AAEA,SAAS,yBAAyB,WAAW;IACzC,IAAI,OAAO,YAAY,YAAY,OAAO;IAE1C,IAAI,oBAAoB,IAAI;IAC5B,IAAI,mBAAmB,IAAI;IAE3B,OAAO,CAAC,2BAA2B,SAAS,WAAW;QACnD,OAAO,cAAc,mBAAmB;IAC5C,CAAC,EAAE;AACP;AACA,SAAS,0BAA0B,GAAG,EAAE,WAAW;IAC/C,IAAI,CAAC,eAAe,OAAO,IAAI,UAAU,EAAE,OAAO;IAClD,IAAI,QAAQ,QAAQ,OAAO,QAAQ,YAAY,OAAO,QAAQ,YAAY,OAAO;QAAE,SAAS;IAAI;IAEhG,IAAI,QAAQ,yBAAyB;IAErC,IAAI,SAAS,MAAM,GAAG,CAAC,MAAM,OAAO,MAAM,GAAG,CAAC;IAE9C,IAAI,SAAS;QAAE,WAAW;IAAK;IAC/B,IAAI,wBAAwB,OAAO,cAAc,IAAI,OAAO,wBAAwB;IAEpF,IAAK,IAAI,OAAO,IAAK;QACjB,IAAI,QAAQ,aAAa,OAAO,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,MAAM;YACrE,IAAI,OAAO,wBAAwB,OAAO,wBAAwB,CAAC,KAAK,OAAO;YAC/E,IAAI,QAAQ,CAAC,KAAK,GAAG,IAAI,KAAK,GAAG,GAAG,OAAO,cAAc,CAAC,QAAQ,KAAK;iBAClE,MAAM,CAAC,IAAI,GAAG,GAAG,CAAC,IAAI;QAC/B;IACJ;IAEA,OAAO,OAAO,GAAG;IAEjB,IAAI,OAAO,MAAM,GAAG,CAAC,KAAK;IAE1B,OAAO;AACX;AACA,QAAQ,CAAC,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 812, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/node_modules/next/src/shared/lib/is-thenable.ts"],"sourcesContent":["/**\n * Check to see if a value is Thenable.\n *\n * @param promise the maybe-thenable value\n * @returns true if the value is thenable\n */\nexport function isThenable<T = unknown>(\n  promise: Promise<T> | T\n): promise is Promise<T> {\n  return (\n    promise !== null &&\n    typeof promise === 'object' &&\n    'then' in promise &&\n    typeof promise.then === 'function'\n  )\n}\n"],"names":["isThenable","promise","then"],"mappings":"AAAA;;;;;CAKC,GAAA;;;;+BACeA,cAAAA;;;eAAAA;;;AAAT,SAASA,WACdC,OAAuB;IAEvB,OACEA,YAAY,QACZ,OAAOA,YAAY,YACnB,UAAUA,WACV,OAAOA,QAAQC,IAAI,KAAK;AAE5B","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 835, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/node_modules/next/src/client/components/react-dev-overlay/utils/dev-indicator/dev-render-indicator.tsx"],"sourcesContent":["/*\n * Singleton store to track whether the app is currently being rendered\n * Used by the dev tools indicator to show render status\n */\n\nimport { useSyncExternalStore } from 'react'\n\nlet isVisible = false\nlet listeners: Array<() => void> = []\n\nconst subscribe = (listener: () => void) => {\n  listeners.push(listener)\n  return () => {\n    listeners = listeners.filter((l) => l !== listener)\n  }\n}\n\nconst getSnapshot = () => isVisible\n\nconst show = () => {\n  isVisible = true\n  listeners.forEach((listener) => listener())\n}\n\nconst hide = () => {\n  isVisible = false\n  listeners.forEach((listener) => listener())\n}\n\nexport function useIsDevRendering() {\n  return useSyncExternalStore(subscribe, getSnapshot)\n}\n\nexport const devRenderIndicator = {\n  show,\n  hide,\n}\n"],"names":["devRenderIndicator","useIsDevRendering","isVisible","listeners","subscribe","listener","push","filter","l","getSnapshot","show","forEach","hide","useSyncExternalStore"],"mappings":"AAAA;;;CAGC,GAAA;;;;;;;;;;;;;;;IA8BYA,kBAAkB,EAAA;eAAlBA;;IAJGC,iBAAiB,EAAA;eAAjBA;;;uBAxBqB;AAErC,IAAIC,YAAY;AAChB,IAAIC,YAA+B,EAAE;AAErC,MAAMC,YAAY,CAACC;IACjBF,UAAUG,IAAI,CAACD;IACf,OAAO;QACLF,YAAYA,UAAUI,MAAM,CAAC,CAACC,IAAMA,MAAMH;IAC5C;AACF;AAEA,MAAMI,cAAc,IAAMP;AAE1B,MAAMQ,OAAO;IACXR,YAAY;IACZC,UAAUQ,OAAO,CAAC,CAACN,WAAaA;AAClC;AAEA,MAAMO,OAAO;IACXV,YAAY;IACZC,UAAUQ,OAAO,CAAC,CAACN,WAAaA;AAClC;AAEO,SAASJ;IACd,OAAOY,CAAAA,GAAAA,OAAAA,oBAAoB,EAACT,WAAWK;AACzC;AAEO,MAAMT,qBAAqB;IAChCU;IACAE;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 897, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/node_modules/next/src/client/components/react-dev-overlay/utils/dev-indicator/use-sync-dev-render-indicator.tsx"],"sourcesContent":["import { useEffect, useTransition } from 'react'\nimport { devRenderIndicator } from './dev-render-indicator'\n\nexport const useSyncDevRenderIndicator = () => {\n  const [isPending, startTransition] = useTransition()\n\n  useEffect(() => {\n    if (isPending) {\n      devRenderIndicator.show()\n    } else {\n      devRenderIndicator.hide()\n    }\n  }, [isPending])\n\n  return startTransition\n}\n"],"names":["useSyncDevRenderIndicator","isPending","startTransition","useTransition","useEffect","devRenderIndicator","show","hide"],"mappings":";;;;+BAGaA,6BAAAA;;;eAAAA;;;uBAH4B;oCACN;AAE5B,MAAMA,4BAA4B;IACvC,MAAM,CAACC,WAAWC,gBAAgB,GAAGC,CAAAA,GAAAA,OAAAA,aAAa;IAElDC,CAAAA,GAAAA,OAAAA,SAAS,EAAC;QACR,IAAIH,WAAW;YACbI,oBAAAA,kBAAkB,CAACC,IAAI;QACzB,OAAO;YACLD,oBAAAA,kBAAkB,CAACE,IAAI;QACzB;IACF,GAAG;QAACN;KAAU;IAEd,OAAOC;AACT","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 934, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/node_modules/next/src/client/components/use-action-queue.ts"],"sourcesContent":["import type { Dispatch } from 'react'\nimport React, { use } from 'react'\nimport { isThenable } from '../../shared/lib/is-thenable'\nimport type { AppRouterActionQueue } from './app-router-instance'\nimport type {\n  AppRouterState,\n  ReducerActions,\n  ReducerState,\n} from './router-reducer/router-reducer-types'\n\n// The app router state lives outside of React, so we can import the dispatch\n// method directly wherever we need it, rather than passing it around via props\n// or context.\nlet dispatch: Dispatch<ReducerActions> | null = null\n\nexport function dispatchAppRouterAction(action: ReducerActions) {\n  if (dispatch === null) {\n    throw new Error(\n      'Internal Next.js error: Router action dispatched before initialization.'\n    )\n  }\n  dispatch(action)\n}\n\nexport function useActionQueue(\n  actionQueue: AppRouterActionQueue\n): AppRouterState {\n  const [state, setState] = React.useState<ReducerState>(actionQueue.state)\n\n  // Because of a known issue that requires to decode Flight streams inside the\n  // render phase, we have to be a bit clever and assign the dispatch method to\n  // a module-level variable upon initialization. The useState hook in this\n  // module only exists to synchronize state that lives outside of React.\n  // Ideally, what we'd do instead is pass the state as a prop to root.render;\n  // this is conceptually how we're modeling the app router state, despite the\n  // weird implementation details.\n  if (process.env.NODE_ENV !== 'production') {\n    const useSyncDevRenderIndicator =\n      require('./react-dev-overlay/utils/dev-indicator/use-sync-dev-render-indicator')\n        .useSyncDevRenderIndicator as typeof import('./react-dev-overlay/utils/dev-indicator/use-sync-dev-render-indicator').useSyncDevRenderIndicator\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    const syncDevRenderIndicator = useSyncDevRenderIndicator()\n\n    dispatch = (action: ReducerActions) => {\n      syncDevRenderIndicator(() => {\n        actionQueue.dispatch(action, setState)\n      })\n    }\n  } else {\n    dispatch = (action: ReducerActions) =>\n      actionQueue.dispatch(action, setState)\n  }\n\n  return isThenable(state) ? use(state) : state\n}\n"],"names":["dispatchAppRouterAction","useActionQueue","dispatch","action","Error","actionQueue","state","setState","React","useState","process","env","NODE_ENV","useSyncDevRenderIndicator","require","syncDevRenderIndicator","isThenable","use"],"mappings":";;;;;;;;;;;;;;;IAegBA,uBAAuB,EAAA;eAAvBA;;IASAC,cAAc,EAAA;eAAdA;;;;iEAvBW;4BACA;AAQ3B,6EAA6E;AAC7E,+EAA+E;AAC/E,cAAc;AACd,IAAIC,WAA4C;AAEzC,SAASF,wBAAwBG,MAAsB;IAC5D,IAAID,aAAa,MAAM;QACrB,MAAM,OAAA,cAEL,CAFK,IAAIE,MACR,4EADI,qBAAA;mBAAA;wBAAA;0BAAA;QAEN;IACF;IACAF,SAASC;AACX;AAEO,SAASF,eACdI,WAAiC;IAEjC,MAAM,CAACC,OAAOC,SAAS,GAAGC,OAAAA,OAAK,CAACC,QAAQ,CAAeJ,YAAYC,KAAK;IAExE,6EAA6E;IAC7E,6EAA6E;IAC7E,yEAAyE;IACzE,uEAAuE;IACvE,4EAA4E;IAC5E,4EAA4E;IAC5E,gCAAgC;IAChC,IAAII,QAAQC,GAAG,CAACC,QAAQ,KAAK,WAAc;QACzC,MAAMC,4BACJC,QAAQ,oKACLD,yBAAyB;QAC9B,sDAAsD;QACtD,MAAME,yBAAyBF;QAE/BX,WAAW,CAACC;YACVY,uBAAuB;gBACrBV,YAAYH,QAAQ,CAACC,QAAQI;YAC/B;QACF;IACF,OAAO;;IAGP;IAEA,OAAOS,CAAAA,GAAAA,YAAAA,UAAU,EAACV,SAASW,CAAAA,GAAAA,OAAAA,GAAG,EAACX,SAASA;AAC1C","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1008, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/node_modules/next/src/client/app-call-server.ts"],"sourcesContent":["import { startTransition } from 'react'\nimport { ACTION_SERVER_ACTION } from './components/router-reducer/router-reducer-types'\nimport { dispatchAppRouterAction } from './components/use-action-queue'\n\nexport async function callServer(actionId: string, actionArgs: any[]) {\n  return new Promise((resolve, reject) => {\n    startTransition(() => {\n      dispatchAppRouterAction({\n        type: ACTION_SERVER_ACTION,\n        actionId,\n        actionArgs,\n        resolve,\n        reject,\n      })\n    })\n  })\n}\n"],"names":["callServer","actionId","actionArgs","Promise","resolve","reject","startTransition","dispatchAppRouterAction","type","ACTION_SERVER_ACTION"],"mappings":";;;;+BAIsBA,cAAAA;;;eAAAA;;;uBAJU;oCACK;gCACG;AAEjC,eAAeA,WAAWC,QAAgB,EAAEC,UAAiB;IAClE,OAAO,IAAIC,QAAQ,CAACC,SAASC;QAC3BC,CAAAA,GAAAA,OAAAA,eAAe,EAAC;YACdC,CAAAA,GAAAA,gBAAAA,uBAAuB,EAAC;gBACtBC,MAAMC,oBAAAA,oBAAoB;gBAC1BR;gBACAC;gBACAE;gBACAC;YACF;QACF;IACF;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1046, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/node_modules/next/src/client/app-find-source-map-url.ts"],"sourcesContent":["const basePath = process.env.__NEXT_ROUTER_BASEPATH || ''\nconst pathname = `${basePath}/__nextjs_source-map`\n\nexport const findSourceMapURL =\n  process.env.NODE_ENV === 'development'\n    ? function findSourceMapURL(filename: string): string | null {\n        if (filename === '') {\n          return null\n        }\n\n        if (\n          filename.startsWith(document.location.origin) &&\n          filename.includes('/_next/static')\n        ) {\n          // This is a request for a client chunk. This can only happen when\n          // using Turbopack. In this case, since we control how those source\n          // maps are generated, we can safely assume that the sourceMappingURL\n          // is relative to the filename, with an added `.map` extension. The\n          // browser can just request this file, and it gets served through the\n          // normal dev server, without the need to route this through\n          // the `/__nextjs_source-map` dev middleware.\n          return `${filename}.map`\n        }\n\n        const url = new URL(pathname, document.location.origin)\n        url.searchParams.set('filename', filename)\n\n        return url.href\n      }\n    : undefined\n"],"names":["findSourceMapURL","basePath","process","env","__NEXT_ROUTER_BASEPATH","pathname","NODE_ENV","filename","startsWith","document","location","origin","includes","url","URL","searchParams","set","href","undefined"],"mappings":";;;;+BAGaA,oBAAAA;;;eAAAA;;;AAHb,MAAMC,WAAWC,QAAQC,GAAG,CAACC,sBAAsB,MAAI;AACvD,MAAMC,WAAY,KAAEJ,WAAS;AAEtB,MAAMD,mBACXE,QAAQC,GAAG,CAACG,QAAQ,KAAK,cACrB,SAASN,iBAAiBO,QAAgB;IACxC,IAAIA,aAAa,IAAI;QACnB,OAAO;IACT;IAEA,IACEA,SAASC,UAAU,CAACC,SAASC,QAAQ,CAACC,MAAM,KAC5CJ,SAASK,QAAQ,CAAC,kBAClB;QACA,kEAAkE;QAClE,mEAAmE;QACnE,qEAAqE;QACrE,mEAAmE;QACnE,qEAAqE;QACrE,4DAA4D;QAC5D,6CAA6C;QAC7C,OAAQ,KAAEL,WAAS;IACrB;IAEA,MAAMM,MAAM,IAAIC,IAAIT,UAAUI,SAASC,QAAQ,CAACC,MAAM;IACtDE,IAAIE,YAAY,CAACC,GAAG,CAAC,YAAYT;IAEjC,OAAOM,IAAII,IAAI;AACjB,IACAC","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1088, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/node_modules/next/src/client/flight-data-helpers.ts"],"sourcesContent":["import type {\n  CacheNodeSeedData,\n  FlightData,\n  FlightDataPath,\n  FlightRouterState,\n  FlightSegmentPath,\n  Segment,\n} from '../server/app-render/types'\nimport type { HeadData } from '../shared/lib/app-router-context.shared-runtime'\n\nexport type NormalizedFlightData = {\n  /**\n   * The full `FlightSegmentPath` inclusive of the final `Segment`\n   */\n  segmentPath: FlightSegmentPath\n  /**\n   * The `FlightSegmentPath` exclusive of the final `Segment`\n   */\n  pathToSegment: FlightSegmentPath\n  segment: Segment\n  tree: FlightRouterState\n  seedData: CacheNodeSeedData | null\n  head: HeadData\n  isHeadPartial: boolean\n  isRootRender: boolean\n}\n\n// TODO: We should only have to export `normalizeFlightData`, however because the initial flight data\n// that gets passed to `createInitialRouterState` doesn't conform to the `FlightDataPath` type (it's missing the root segment)\n// we're currently exporting it so we can use it directly. This should be fixed as part of the unification of\n// the different ways we express `FlightSegmentPath`.\nexport function getFlightDataPartsFromPath(\n  flightDataPath: FlightDataPath\n): NormalizedFlightData {\n  // Pick the last 4 items from the `FlightDataPath` to get the [tree, seedData, viewport, isHeadPartial].\n  const flightDataPathLength = 4\n  // tree, seedData, and head are *always* the last three items in the `FlightDataPath`.\n  const [tree, seedData, head, isHeadPartial] =\n    flightDataPath.slice(-flightDataPathLength)\n  // The `FlightSegmentPath` is everything except the last three items. For a root render, it won't be present.\n  const segmentPath = flightDataPath.slice(0, -flightDataPathLength)\n\n  return {\n    // TODO: Unify these two segment path helpers. We are inconsistently pushing an empty segment (\"\")\n    // to the start of the segment path in some places which makes it hard to use solely the segment path.\n    // Look for \"// TODO-APP: remove ''\" in the codebase.\n    pathToSegment: segmentPath.slice(0, -1),\n    segmentPath,\n    // if the `FlightDataPath` corresponds with the root, there'll be no segment path,\n    // in which case we default to ''.\n    segment: segmentPath[segmentPath.length - 1] ?? '',\n    tree,\n    seedData,\n    head,\n    isHeadPartial,\n    isRootRender: flightDataPath.length === flightDataPathLength,\n  }\n}\n\nexport function getNextFlightSegmentPath(\n  flightSegmentPath: FlightSegmentPath\n): FlightSegmentPath {\n  // Since `FlightSegmentPath` is a repeated tuple of `Segment` and `ParallelRouteKey`, we slice off two items\n  // to get the next segment path.\n  return flightSegmentPath.slice(2)\n}\n\nexport function normalizeFlightData(\n  flightData: FlightData\n): NormalizedFlightData[] | string {\n  // FlightData can be a string when the server didn't respond with a proper flight response,\n  // or when a redirect happens, to signal to the client that it needs to perform an MPA navigation.\n  if (typeof flightData === 'string') {\n    return flightData\n  }\n\n  return flightData.map(getFlightDataPartsFromPath)\n}\n"],"names":["getFlightDataPartsFromPath","getNextFlightSegmentPath","normalizeFlightData","flightDataPath","flightDataPathLength","tree","seedData","head","isHeadPartial","slice","segmentPath","pathToSegment","segment","length","isRootRender","flightSegmentPath","flightData","map"],"mappings":";;;;;;;;;;;;;;;;IA+BgBA,0BAA0B,EAAA;eAA1BA;;IA4BAC,wBAAwB,EAAA;eAAxBA;;IAQAC,mBAAmB,EAAA;eAAnBA;;;AApCT,SAASF,2BACdG,cAA8B;IAE9B,wGAAwG;IACxG,MAAMC,uBAAuB;IAC7B,sFAAsF;IACtF,MAAM,CAACC,MAAMC,UAAUC,MAAMC,cAAc,GACzCL,eAAeM,KAAK,CAAC,CAACL;IACxB,6GAA6G;IAC7G,MAAMM,cAAcP,eAAeM,KAAK,CAAC,GAAG,CAACL;QAUlCM;IARX,OAAO;QACL,kGAAkG;QAClG,sGAAsG;QACtG,qDAAqD;QACrDC,eAAeD,YAAYD,KAAK,CAAC,GAAG,CAAC;QACrCC;QACA,kFAAkF;QAClF,kCAAkC;QAClCE,SAASF,CAAAA,gBAAAA,WAAW,CAACA,YAAYG,MAAM,GAAG,EAAE,KAAA,OAAnCH,gBAAuC;QAChDL;QACAC;QACAC;QACAC;QACAM,cAAcX,eAAeU,MAAM,KAAKT;IAC1C;AACF;AAEO,SAASH,yBACdc,iBAAoC;IAEpC,4GAA4G;IAC5G,gCAAgC;IAChC,OAAOA,kBAAkBN,KAAK,CAAC;AACjC;AAEO,SAASP,oBACdc,UAAsB;IAEtB,2FAA2F;IAC3F,kGAAkG;IAClG,IAAI,OAAOA,eAAe,UAAU;QAClC,OAAOA;IACT;IAEA,OAAOA,WAAWC,GAAG,CAACjB;AACxB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1163, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/node_modules/next/src/client/app-build-id.ts"],"sourcesContent":["// This gets assigned as a side-effect during app initialization. Because it\n// represents the build used to create the JS bundle, it should never change\n// after being set, so we store it in a global variable.\n//\n// When performing RSC requests, if the incoming data has a different build ID,\n// we perform an MPA navigation/refresh to load the updated build and ensure\n// that the client and server in sync.\n\n// Starts as an empty string. In practice, because setAppBuildId is called\n// during initialization before hydration starts, this will always get\n// reassigned to the actual build ID before it's ever needed by a navigation.\n// If for some reasons it didn't, due to a bug or race condition, then on\n// navigation the build comparision would fail and trigger an MPA navigation.\nlet globalBuildId: string = ''\n\nexport function setAppBuildId(buildId: string) {\n  globalBuildId = buildId\n}\n\nexport function getAppBuildId(): string {\n  return globalBuildId\n}\n"],"names":["getAppBuildId","setAppBuildId","globalBuildId","buildId"],"mappings":"AAAA,4EAA4E;AAC5E,4EAA4E;AAC5E,wDAAwD;AACxD,EAAE;AACF,+EAA+E;AAC/E,4EAA4E;AAC5E,sCAAsC;AAEtC,0EAA0E;AAC1E,sEAAsE;AACtE,6EAA6E;AAC7E,yEAAyE;AACzE,6EAA6E;;;;;;;;;;;;;;;;IAO7DA,aAAa,EAAA;eAAbA;;IAJAC,aAAa,EAAA;eAAbA;;;AAFhB,IAAIC,gBAAwB;AAErB,SAASD,cAAcE,OAAe;IAC3CD,gBAAgBC;AAClB;AAEO,SAASH;IACd,OAAOE;AACT","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1216, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/node_modules/next/src/shared/lib/hash.ts"],"sourcesContent":["// http://www.cse.yorku.ca/~oz/hash.html\n// More specifically, 32-bit hash via djbxor\n// (ref: https://gist.github.com/eplawless/52813b1d8ad9af510d85?permalink_comment_id=3367765#gistcomment-3367765)\n// This is due to number type differences between rust for turbopack to js number types,\n// where rust does not have easy way to repreesnt js's 53-bit float number type for the matching\n// overflow behavior. This is more `correct` in terms of having canonical hash across different runtime / implementation\n// as can gaurantee determinstic output from 32bit hash.\nexport function djb2Hash(str: string) {\n  let hash = 5381\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i)\n    hash = ((hash << 5) + hash + char) & 0xffffffff\n  }\n  return hash >>> 0\n}\n\nexport function hexHash(str: string) {\n  return djb2Hash(str).toString(36).slice(0, 5)\n}\n"],"names":["djb2Hash","hexHash","str","hash","i","length","char","charCodeAt","toString","slice"],"mappings":"AAAA,wCAAwC;AACxC,4CAA4C;AAC5C,iHAAiH;AACjH,wFAAwF;AACxF,gGAAgG;AAChG,wHAAwH;AACxH,wDAAwD;;;;;;;;;;;;;;;;IACxCA,QAAQ,EAAA;eAARA;;IASAC,OAAO,EAAA;eAAPA;;;AATT,SAASD,SAASE,GAAW;IAClC,IAAIC,OAAO;IACX,IAAK,IAAIC,IAAI,GAAGA,IAAIF,IAAIG,MAAM,EAAED,IAAK;QACnC,MAAME,OAAOJ,IAAIK,UAAU,CAACH;QAC5BD,OAASA,CAAAA,QAAQ,CAAA,IAAKA,OAAOG,OAAQ;IACvC;IACA,OAAOH,SAAS;AAClB;AAEO,SAASF,QAAQC,GAAW;IACjC,OAAOF,SAASE,KAAKM,QAAQ,CAAC,IAAIC,KAAK,CAAC,GAAG;AAC7C","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1261, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/node_modules/next/src/client/components/router-reducer/set-cache-busting-search-param.ts"],"sourcesContent":["'use client'\nimport { hexHash } from '../../../shared/lib/hash'\nimport {\n  NEXT_ROUTER_PREFETCH_HEADER,\n  NEXT_ROUTER_SEGMENT_PREFETCH_HEADER,\n  NEXT_ROUTER_STATE_TREE_HEADER,\n  NEXT_URL,\n  NEXT_RSC_UNION_QUERY,\n} from '../app-router-headers'\nimport type { RequestHeaders } from './fetch-server-response'\n\n/**\n * Mutates the provided URL by adding a cache-busting search parameter for CDNs that don't\n * support custom headers. This helps avoid caching conflicts by making each request unique.\n *\n * Rather than relying on the Vary header which some CDNs ignore, we append a search param\n * to create a unique URL that forces a fresh request.\n *\n * Example:\n * URL before: https://example.com/path?query=1\n * URL after: https://example.com/path?query=1&_rsc=abc123\n *\n * Note: This function mutates the input URL directly and does not return anything.\n *\n * TODO: Since we need to use a search param anyway, we could simplify by removing the custom\n * headers approach entirely and just use search params.\n */\nexport const setCacheBustingSearchParam = (\n  url: URL,\n  headers: RequestHeaders\n): void => {\n  const uniqueCacheKey = hexHash(\n    [\n      headers[NEXT_ROUTER_PREFETCH_HEADER] || '0',\n      headers[NEXT_ROUTER_SEGMENT_PREFETCH_HEADER] || '0',\n      headers[NEXT_ROUTER_STATE_TREE_HEADER],\n      headers[NEXT_URL],\n    ].join(',')\n  )\n\n  /**\n   * Note that we intentionally do not use `url.searchParams.set` here:\n   *\n   * const url = new URL('https://example.com/search?q=custom%20spacing');\n   * url.searchParams.set('_rsc', 'abc123');\n   * console.log(url.toString()); // Outputs: https://example.com/search?q=custom+spacing&_rsc=abc123\n   *                                                                             ^ <--- this is causing confusion\n   * This is in fact intended based on https://url.spec.whatwg.org/#interface-urlsearchparams, but\n   * we want to preserve the %20 as %20 if that's what the user passed in, hence the custom\n   * logic below.\n   */\n  const existingSearch = url.search\n  const rawQuery = existingSearch.startsWith('?')\n    ? existingSearch.slice(1)\n    : existingSearch\n  const pairs = rawQuery.split('&').filter(Boolean)\n  pairs.push(`${NEXT_RSC_UNION_QUERY}=${uniqueCacheKey}`)\n  url.search = pairs.length ? `?${pairs.join('&')}` : ''\n}\n"],"names":["setCacheBustingSearchParam","url","headers","uniqueCacheKey","hexHash","NEXT_ROUTER_PREFETCH_HEADER","NEXT_ROUTER_SEGMENT_PREFETCH_HEADER","NEXT_ROUTER_STATE_TREE_HEADER","NEXT_URL","join","existingSearch","search","rawQuery","startsWith","slice","pairs","split","filter","Boolean","push","NEXT_RSC_UNION_QUERY","length"],"mappings":"AAAA;;;;;+BA2BaA,8BAAAA;;;eAAAA;;;sBA1BW;kCAOjB;AAmBA,MAAMA,6BAA6B,CACxCC,KACAC;IAEA,MAAMC,iBAAiBC,CAAAA,GAAAA,MAAAA,OAAO,EAC5B;QACEF,OAAO,CAACG,kBAAAA,2BAA2B,CAAC,IAAI;QACxCH,OAAO,CAACI,kBAAAA,mCAAmC,CAAC,IAAI;QAChDJ,OAAO,CAACK,kBAAAA,6BAA6B,CAAC;QACtCL,OAAO,CAACM,kBAAAA,QAAQ,CAAC;KAClB,CAACC,IAAI,CAAC;IAGT;;;;;;;;;;GAUC,GACD,MAAMC,iBAAiBT,IAAIU,MAAM;IACjC,MAAMC,WAAWF,eAAeG,UAAU,CAAC,OACvCH,eAAeI,KAAK,CAAC,KACrBJ;IACJ,MAAMK,QAAQH,SAASI,KAAK,CAAC,KAAKC,MAAM,CAACC;IACzCH,MAAMI,IAAI,CAAIC,kBAAAA,oBAAoB,GAAC,MAAGjB;IACtCF,IAAIU,MAAM,GAAGI,MAAMM,MAAM,GAAI,MAAGN,MAAMN,IAAI,CAAC,OAAS;AACtD","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1309, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client-edge.ts"],"sourcesContent":["module.exports = require('../../module.compiled').vendored[\n  'react-ssr'\n].ReactServerDOMTurbopackClientEdge\n"],"names":["module","exports","require","vendored","ReactServerDOMTurbopackClientEdge"],"mappings":";AAAAA,OAAOC,OAAO,GAAGC,QAAQ,4HAAyBC,QAAQ,CACxD,YACD,CAACC,iCAAiC","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1316, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/node_modules/next/src/client/components/router-reducer/fetch-server-response.ts"],"sourcesContent":["'use client'\n\n// @ts-ignore\n// eslint-disable-next-line import/no-extraneous-dependencies\n// import { createFromReadableStream } from 'react-server-dom-webpack/client'\nconst { createFromReadableStream } = (\n  !!process.env.NEXT_RUNTIME\n    ? // eslint-disable-next-line import/no-extraneous-dependencies\n      require('react-server-dom-webpack/client.edge')\n    : // eslint-disable-next-line import/no-extraneous-dependencies\n      require('react-server-dom-webpack/client')\n) as typeof import('react-server-dom-webpack/client')\n\nimport type {\n  FlightRouterState,\n  NavigationFlightResponse,\n} from '../../../server/app-render/types'\n\nimport type { NEXT_ROUTER_SEGMENT_PREFETCH_HEADER } from '../app-router-headers'\nimport {\n  NEXT_ROUTER_PREFETCH_HEADER,\n  NEXT_ROUTER_STATE_TREE_HEADER,\n  NEXT_RSC_UNION_QUERY,\n  NEXT_URL,\n  RSC_HEADER,\n  RSC_CONTENT_TYPE_HEADER,\n  NEXT_HMR_REFRESH_HEADER,\n  NEXT_DID_POSTPONE_HEADER,\n  NEXT_ROUTER_STALE_TIME_HEADER,\n} from '../app-router-headers'\nimport { callServer } from '../../app-call-server'\nimport { findSourceMapURL } from '../../app-find-source-map-url'\nimport { PrefetchKind } from './router-reducer-types'\nimport {\n  normalizeFlightData,\n  type NormalizedFlightData,\n} from '../../flight-data-helpers'\nimport { getAppBuildId } from '../../app-build-id'\nimport { setCacheBustingSearchParam } from './set-cache-busting-search-param'\n\nexport interface FetchServerResponseOptions {\n  readonly flightRouterState: FlightRouterState\n  readonly nextUrl: string | null\n  readonly prefetchKind?: PrefetchKind\n  readonly isHmrRefresh?: boolean\n}\n\nexport type FetchServerResponseResult = {\n  flightData: NormalizedFlightData[] | string\n  canonicalUrl: URL | undefined\n  couldBeIntercepted: boolean\n  prerendered: boolean\n  postponed: boolean\n  staleTime: number\n}\n\nexport type RequestHeaders = {\n  [RSC_HEADER]?: '1'\n  [NEXT_ROUTER_STATE_TREE_HEADER]?: string\n  [NEXT_URL]?: string\n  [NEXT_ROUTER_PREFETCH_HEADER]?: '1'\n  [NEXT_ROUTER_SEGMENT_PREFETCH_HEADER]?: string\n  'x-deployment-id'?: string\n  [NEXT_HMR_REFRESH_HEADER]?: '1'\n  // A header that is only added in test mode to assert on fetch priority\n  'Next-Test-Fetch-Priority'?: RequestInit['priority']\n}\n\nexport function urlToUrlWithoutFlightMarker(url: string): URL {\n  const urlWithoutFlightParameters = new URL(url, location.origin)\n  urlWithoutFlightParameters.searchParams.delete(NEXT_RSC_UNION_QUERY)\n  if (process.env.NODE_ENV === 'production') {\n    if (\n      process.env.__NEXT_CONFIG_OUTPUT === 'export' &&\n      urlWithoutFlightParameters.pathname.endsWith('.txt')\n    ) {\n      const { pathname } = urlWithoutFlightParameters\n      const length = pathname.endsWith('/index.txt') ? 10 : 4\n      // Slice off `/index.txt` or `.txt` from the end of the pathname\n      urlWithoutFlightParameters.pathname = pathname.slice(0, -length)\n    }\n  }\n  return urlWithoutFlightParameters\n}\n\nfunction doMpaNavigation(url: string): FetchServerResponseResult {\n  return {\n    flightData: urlToUrlWithoutFlightMarker(url).toString(),\n    canonicalUrl: undefined,\n    couldBeIntercepted: false,\n    prerendered: false,\n    postponed: false,\n    staleTime: -1,\n  }\n}\n\nlet abortController = new AbortController()\n\nif (typeof window !== 'undefined') {\n  // Abort any in-flight requests when the page is unloaded, e.g. due to\n  // reloading the page or performing hard navigations. This allows us to ignore\n  // what would otherwise be a thrown TypeError when the browser cancels the\n  // requests.\n  window.addEventListener('pagehide', () => {\n    abortController.abort()\n  })\n\n  // Use a fresh AbortController instance on pageshow, e.g. when navigating back\n  // and the JavaScript execution context is restored by the browser.\n  window.addEventListener('pageshow', () => {\n    abortController = new AbortController()\n  })\n}\n\n/**\n * Fetch the flight data for the provided url. Takes in the current router state\n * to decide what to render server-side.\n */\nexport async function fetchServerResponse(\n  url: URL,\n  options: FetchServerResponseOptions\n): Promise<FetchServerResponseResult> {\n  const { flightRouterState, nextUrl, prefetchKind } = options\n\n  const headers: RequestHeaders = {\n    // Enable flight response\n    [RSC_HEADER]: '1',\n    // Provide the current router state\n    [NEXT_ROUTER_STATE_TREE_HEADER]: encodeURIComponent(\n      JSON.stringify(flightRouterState)\n    ),\n  }\n\n  /**\n   * Three cases:\n   * - `prefetchKind` is `undefined`, it means it's a normal navigation, so we want to prefetch the page data fully\n   * - `prefetchKind` is `full` - we want to prefetch the whole page so same as above\n   * - `prefetchKind` is `auto` - if the page is dynamic, prefetch the page data partially, if static prefetch the page data fully\n   */\n  if (prefetchKind === PrefetchKind.AUTO) {\n    headers[NEXT_ROUTER_PREFETCH_HEADER] = '1'\n  }\n\n  if (process.env.NODE_ENV === 'development' && options.isHmrRefresh) {\n    headers[NEXT_HMR_REFRESH_HEADER] = '1'\n  }\n\n  if (nextUrl) {\n    headers[NEXT_URL] = nextUrl\n  }\n\n  try {\n    // When creating a \"temporary\" prefetch (the \"on-demand\" prefetch that gets created on navigation, if one doesn't exist)\n    // we send the request with a \"high\" priority as it's in response to a user interaction that could be blocking a transition.\n    // Otherwise, all other prefetches are sent with a \"low\" priority.\n    // We use \"auto\" for in all other cases to match the existing default, as this function is shared outside of prefetching.\n    const fetchPriority = prefetchKind\n      ? prefetchKind === PrefetchKind.TEMPORARY\n        ? 'high'\n        : 'low'\n      : 'auto'\n\n    if (process.env.NODE_ENV === 'production') {\n      if (process.env.__NEXT_CONFIG_OUTPUT === 'export') {\n        // In \"output: export\" mode, we can't rely on headers to distinguish\n        // between HTML and RSC requests. Instead, we append an extra prefix\n        // to the request.\n        url = new URL(url)\n        if (url.pathname.endsWith('/')) {\n          url.pathname += 'index.txt'\n        } else {\n          url.pathname += '.txt'\n        }\n      }\n    }\n\n    const res = await createFetch(\n      url,\n      headers,\n      fetchPriority,\n      abortController.signal\n    )\n\n    const responseUrl = urlToUrlWithoutFlightMarker(res.url)\n    const canonicalUrl = res.redirected ? responseUrl : undefined\n\n    const contentType = res.headers.get('content-type') || ''\n    const interception = !!res.headers.get('vary')?.includes(NEXT_URL)\n    const postponed = !!res.headers.get(NEXT_DID_POSTPONE_HEADER)\n    const staleTimeHeaderSeconds = res.headers.get(\n      NEXT_ROUTER_STALE_TIME_HEADER\n    )\n    const staleTime =\n      staleTimeHeaderSeconds !== null\n        ? parseInt(staleTimeHeaderSeconds, 10) * 1000\n        : -1\n    let isFlightResponse = contentType.startsWith(RSC_CONTENT_TYPE_HEADER)\n\n    if (process.env.NODE_ENV === 'production') {\n      if (process.env.__NEXT_CONFIG_OUTPUT === 'export') {\n        if (!isFlightResponse) {\n          isFlightResponse = contentType.startsWith('text/plain')\n        }\n      }\n    }\n\n    // If fetch returns something different than flight response handle it like a mpa navigation\n    // If the fetch was not 200, we also handle it like a mpa navigation\n    if (!isFlightResponse || !res.ok || !res.body) {\n      // in case the original URL came with a hash, preserve it before redirecting to the new URL\n      if (url.hash) {\n        responseUrl.hash = url.hash\n      }\n\n      return doMpaNavigation(responseUrl.toString())\n    }\n\n    // We may navigate to a page that requires a different Webpack runtime.\n    // In prod, every page will have the same Webpack runtime.\n    // In dev, the Webpack runtime is minimal for each page.\n    // We need to ensure the Webpack runtime is updated before executing client-side JS of the new page.\n    if (process.env.NODE_ENV !== 'production' && !process.env.TURBOPACK) {\n      await require('../react-dev-overlay/app/hot-reloader-client').waitForWebpackRuntimeHotUpdate()\n    }\n\n    // Handle the `fetch` readable stream that can be unwrapped by `React.use`.\n    const flightStream = postponed\n      ? createUnclosingPrefetchStream(res.body)\n      : res.body\n    const response = await (createFromNextReadableStream(\n      flightStream\n    ) as Promise<NavigationFlightResponse>)\n\n    if (getAppBuildId() !== response.b) {\n      return doMpaNavigation(res.url)\n    }\n\n    return {\n      flightData: normalizeFlightData(response.f),\n      canonicalUrl: canonicalUrl,\n      couldBeIntercepted: interception,\n      prerendered: response.S,\n      postponed,\n      staleTime,\n    }\n  } catch (err) {\n    if (!abortController.signal.aborted) {\n      console.error(\n        `Failed to fetch RSC payload for ${url}. Falling back to browser navigation.`,\n        err\n      )\n    }\n\n    // If fetch fails handle it like a mpa navigation\n    // TODO-APP: Add a test for the case where a CORS request fails, e.g. external url redirect coming from the response.\n    // See https://github.com/vercel/next.js/issues/43605#issuecomment-1451617521 for a reproduction.\n    return {\n      flightData: url.toString(),\n      canonicalUrl: undefined,\n      couldBeIntercepted: false,\n      prerendered: false,\n      postponed: false,\n      staleTime: -1,\n    }\n  }\n}\n\nexport function createFetch(\n  url: URL,\n  headers: RequestHeaders,\n  fetchPriority: 'auto' | 'high' | 'low' | null,\n  signal?: AbortSignal\n) {\n  const fetchUrl = new URL(url)\n\n  // TODO: In output: \"export\" mode, the headers do nothing. Omit them (and the\n  // cache busting search param) from the request so they're\n  // maximally cacheable.\n  setCacheBustingSearchParam(fetchUrl, headers)\n\n  if (process.env.__NEXT_TEST_MODE && fetchPriority !== null) {\n    headers['Next-Test-Fetch-Priority'] = fetchPriority\n  }\n\n  if (process.env.NEXT_DEPLOYMENT_ID) {\n    headers['x-deployment-id'] = process.env.NEXT_DEPLOYMENT_ID\n  }\n\n  return fetch(fetchUrl, {\n    // Backwards compat for older browsers. `same-origin` is the default in modern browsers.\n    credentials: 'same-origin',\n    headers,\n    priority: fetchPriority || undefined,\n    signal,\n  })\n}\n\nexport function createFromNextReadableStream(\n  flightStream: ReadableStream<Uint8Array>\n): Promise<unknown> {\n  return createFromReadableStream(flightStream, {\n    callServer,\n    findSourceMapURL,\n  })\n}\n\nfunction createUnclosingPrefetchStream(\n  originalFlightStream: ReadableStream<Uint8Array>\n): ReadableStream<Uint8Array> {\n  // When PPR is enabled, prefetch streams may contain references that never\n  // resolve, because that's how we encode dynamic data access. In the decoded\n  // object returned by the Flight client, these are reified into hanging\n  // promises that suspend during render, which is effectively what we want.\n  // The UI resolves when it switches to the dynamic data stream\n  // (via useDeferredValue(dynamic, static)).\n  //\n  // However, the Flight implementation currently errors if the server closes\n  // the response before all the references are resolved. As a cheat to work\n  // around this, we wrap the original stream in a new stream that never closes,\n  // and therefore doesn't error.\n  const reader = originalFlightStream.getReader()\n  return new ReadableStream({\n    async pull(controller) {\n      while (true) {\n        const { done, value } = await reader.read()\n        if (!done) {\n          // Pass to the target stream and keep consuming the Flight response\n          // from the server.\n          controller.enqueue(value)\n          continue\n        }\n        // The server stream has closed. Exit, but intentionally do not close\n        // the target stream.\n        return\n      }\n    },\n  })\n}\n"],"names":["createFetch","createFromNextReadableStream","fetchServerResponse","urlToUrlWithoutFlightMarker","createFromReadableStream","process","env","NEXT_RUNTIME","require","url","urlWithoutFlightParameters","URL","location","origin","searchParams","delete","NEXT_RSC_UNION_QUERY","NODE_ENV","__NEXT_CONFIG_OUTPUT","pathname","endsWith","length","slice","doMpaNavigation","flightData","toString","canonicalUrl","undefined","couldBeIntercepted","prerendered","postponed","staleTime","abortController","AbortController","window","addEventListener","abort","options","flightRouterState","nextUrl","prefetchKind","headers","RSC_HEADER","NEXT_ROUTER_STATE_TREE_HEADER","encodeURIComponent","JSON","stringify","PrefetchKind","AUTO","NEXT_ROUTER_PREFETCH_HEADER","isHmrRefresh","NEXT_HMR_REFRESH_HEADER","NEXT_URL","res","fetchPriority","TEMPORARY","signal","responseUrl","redirected","contentType","get","interception","includes","NEXT_DID_POSTPONE_HEADER","staleTimeHeaderSeconds","NEXT_ROUTER_STALE_TIME_HEADER","parseInt","isFlightResponse","startsWith","RSC_CONTENT_TYPE_HEADER","ok","body","hash","TURBOPACK","waitForWebpackRuntimeHotUpdate","flightStream","createUnclosingPrefetchStream","response","getAppBuildId","b","normalizeFlightData","f","S","err","aborted","console","error","fetchUrl","setCacheBustingSearchParam","__NEXT_TEST_MODE","NEXT_DEPLOYMENT_ID","fetch","credentials","priority","callServer","findSourceMapURL","originalFlightStream","reader","getReader","ReadableStream","pull","controller","done","value","read","enqueue"],"mappings":"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","ignoreList":[0],"debugId":null}}]
}