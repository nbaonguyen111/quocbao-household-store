{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///D:/cmder/quocbao-household-store/tg-dienmay/src/app/admin/danh-muc/page.jsx"],"sourcesContent":["'use client';\r\nimport { collection, getDocs, deleteDoc, doc, updateDoc, setDoc } from \"firebase/firestore\";\r\nimport { db } from \"@/firebase/firebase\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { FaPlus, FaTrash, FaEdit, FaList, FaTags, FaImage, FaTimes } from \"react-icons/fa\";\r\n\r\nexport default function Danhmuc() {\r\n  const [categories, setCategories] = useState([]);\r\n  const [form, setForm] = useState({ id: \"\", name: \"\", icon: \"\" });\r\n  const [editId, setEditId] = useState(null);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  \r\n  const fetchCategories = async () => {\r\n    setLoading(true);\r\n    const snap = await getDocs(collection(db, \"categories\"));\r\n    setCategories(snap.docs.map(doc => ({ id: doc.id, ...doc.data() })));\r\n    setLoading(false);\r\n  };\r\n\r\n  useEffect(() => { fetchCategories(); }, []);\r\n\r\n  useEffect(() => {\r\n    if (message) {\r\n      const t = setTimeout(() => setMessage(\"\"), 2000);\r\n      return () => clearTimeout(t);\r\n    }\r\n  }, [message]);\r\n\r\n  \r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!form.id.trim() || !form.name.trim()) return;\r\n    try {\r\n      \r\n      if (!editId && categories.some(c => c.id === form.id.trim())) {\r\n        setMessage(\"ID này đã tồn tại, vui lòng chọn ID khác!\");\r\n        return;\r\n      }\r\n      if (editId) {\r\n        \r\n        await updateDoc(doc(db, \"categories\", editId), {\r\n          name: form.name.trim(),\r\n          icon: form.icon.trim(),\r\n        });\r\n        setMessage(\"Cập nhật thành công!\");\r\n      } else {\r\n        \r\n        await setDoc(doc(db, \"categories\", form.id.trim()), {\r\n          name: form.name.trim(),\r\n          icon: form.icon.trim(),\r\n        });\r\n        setMessage(\"Thêm danh mục thành công!\");\r\n      }\r\n      setForm({ id: \"\", name: \"\", icon: \"\" });\r\n      setEditId(null);\r\n      fetchCategories();\r\n    } catch (err) {\r\n      setMessage(\"Có lỗi xảy ra khi cập nhật/thêm danh mục!\");\r\n      console.error(err);\r\n    }\r\n  };\r\n\r\n  \r\n  const handleDelete = async (id) => {\r\n    if (!confirm(\"Bạn chắc chắn muốn xóa danh mục này?\")) return;\r\n    await deleteDoc(doc(db, \"categories\", id));\r\n    setMessage(\"Đã xóa danh mục!\");\r\n    fetchCategories();\r\n  };\r\n\r\n  \r\n  const handleEdit = (cat) => {\r\n    setEditId(cat.id);\r\n    setForm({ id: cat.id, name: cat.name, icon: cat.icon || \"\" });\r\n  };\r\n\r\n \r\n  const handleCancel = () => {\r\n    setEditId(null);\r\n    setForm({ id: \"\", name: \"\", icon: \"\" });\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100 p-8\">\r\n      <div className=\"max-w-2xl mx-auto bg-white rounded-xl shadow-lg p-8\">\r\n        <h1 className=\"text-2xl font-bold text-blue-700 mb-6 flex items-center gap-2\">\r\n          <FaList className=\"text-blue-500\" /> Quản lý danh mục sản phẩm\r\n        </h1>\r\n        {message && (\r\n          <div className=\"mb-4 px-4 py-2 bg-green-100 border border-green-300 text-green-700 rounded shadow text-center animate-bounce\">\r\n            {message}\r\n          </div>\r\n        )}\r\n        <form onSubmit={handleSubmit} className=\"flex gap-2 mb-6 flex-wrap\">\r\n          <input\r\n            type=\"text\"\r\n            className=\"border rounded px-3 py-2 flex-1 focus:ring-2 focus:ring-blue-300\"\r\n            placeholder=\"ID (ví dụ: tv, ac, fridge...)\"\r\n            value={form.id}\r\n            onChange={e => setForm({ ...form, id: e.target.value })}\r\n            \r\n          />\r\n          <input\r\n            type=\"text\"\r\n            className=\"border rounded px-3 py-2 flex-1 focus:ring-2 focus:ring-blue-300\"\r\n            placeholder=\"Tên danh mục...\"\r\n            value={form.name}\r\n            onChange={e => setForm({ ...form, name: e.target.value })}\r\n          />\r\n          <input\r\n            type=\"text\"\r\n            className=\"border rounded px-3 py-2 flex-1 focus:ring-2 focus:ring-blue-300\"\r\n            placeholder=\"Link ảnh icon (VD: /images/tivi.png)\"\r\n            value={form.icon}\r\n            onChange={e => setForm({ ...form, icon: e.target.value })}\r\n          />\r\n          <button\r\n            type=\"submit\"\r\n            className={`flex items-center gap-1 px-4 py-2 rounded text-white font-semibold transition\r\n              ${editId ? \"bg-yellow-500 hover:bg-yellow-600\" : \"bg-blue-600 hover:bg-blue-700\"}`}\r\n          >\r\n            {editId ? <FaEdit /> : <FaPlus />}\r\n            {editId ? \"Cập nhật\" : \"Thêm\"}\r\n          </button>\r\n          {editId && (\r\n            <button\r\n              type=\"button\"\r\n              className=\"px-3 py-2 rounded bg-gray-300 hover:bg-gray-400 text-gray-700 font-semibold flex items-center gap-1\"\r\n              onClick={handleCancel}\r\n            >\r\n              <FaTimes /> Hủy\r\n            </button>\r\n          )}\r\n        </form>\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"min-w-full border text-sm rounded-lg overflow-hidden shadow\">\r\n            <thead>\r\n              <tr className=\"bg-blue-100\">\r\n                <th className=\"p-2 border text-left\">ID</th>\r\n                <th className=\"p-2 border text-left\">Tên danh mục</th>\r\n                <th className=\"p-2 border text-left\">Icon</th>\r\n                <th className=\"p-2 border w-32 text-center\">Thao tác</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {categories.map((c) => (\r\n                <tr key={c.id} className=\"hover:bg-blue-50 transition\">\r\n                  <td className=\"p-2 border\">{c.id}</td>\r\n                  <td className=\"p-2 border\">{c.name}</td>\r\n                  <td className=\"p-2 border\">\r\n                    {c.icon ? (\r\n                      <img src={c.icon} alt={c.name} className=\"w-10 h-10 object-contain rounded shadow border\" />\r\n                    ) : (\r\n                      <span className=\"text-gray-400 flex items-center gap-1\"><FaImage /> Không có</span>\r\n                    )}\r\n                  </td>\r\n                  <td className=\"p-2 border flex gap-2 justify-center\">\r\n                    <button\r\n                      className=\"text-yellow-600 hover:text-yellow-800\"\r\n                      onClick={() => handleEdit(c)}\r\n                      title=\"Sửa\"\r\n                    >\r\n                      <FaEdit />\r\n                    </button>\r\n                    <button\r\n                      className=\"text-red-600 hover:text-red-800\"\r\n                      onClick={() => handleDelete(c.id)}\r\n                      title=\"Xóa\"\r\n                    >\r\n                      <FaTrash />\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n              {categories.length === 0 && (\r\n                <tr>\r\n                  <td colSpan={4} className=\"text-center text-gray-500 py-4\">Chưa có danh mục nào.</td>\r\n                </tr>\r\n              )}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        {loading && <div className=\"text-center text-blue-600 mt-4\">Đang tải dữ liệu...</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AAAA;AACA;AACA;AACA;AAJA;;;;;;AAMe,SAAS;IACtB,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE,EAAE;IAC/C,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;QAAE,IAAI;QAAI,MAAM;QAAI,MAAM;IAAG;IAC9D,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAGvC,MAAM,kBAAkB;QACtB,WAAW;QACX,MAAM,OAAO,MAAM,CAAA,GAAA,iKAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,iKAAA,CAAA,aAAU,AAAD,EAAE,2HAAA,CAAA,KAAE,EAAE;QAC1C,cAAc,KAAK,IAAI,CAAC,GAAG,CAAC,CAAA,MAAO,CAAC;gBAAE,IAAI,IAAI,EAAE;gBAAE,GAAG,IAAI,IAAI,EAAE;YAAC,CAAC;QACjE,WAAW;IACb;IAEA,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QAAQ;IAAmB,GAAG,EAAE;IAE1C,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,IAAI,SAAS;YACX,MAAM,IAAI,WAAW,IAAM,WAAW,KAAK;YAC3C,OAAO,IAAM,aAAa;QAC5B;IACF,GAAG;QAAC;KAAQ;IAGZ,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAChB,IAAI,CAAC,KAAK,EAAE,CAAC,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC,IAAI,IAAI;QAC1C,IAAI;YAEF,IAAI,CAAC,UAAU,WAAW,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,KAAK,EAAE,CAAC,IAAI,KAAK;gBAC5D,WAAW;gBACX;YACF;YACA,IAAI,QAAQ;gBAEV,MAAM,CAAA,GAAA,iKAAA,CAAA,YAAS,AAAD,EAAE,CAAA,GAAA,iKAAA,CAAA,MAAG,AAAD,EAAE,2HAAA,CAAA,KAAE,EAAE,cAAc,SAAS;oBAC7C,MAAM,KAAK,IAAI,CAAC,IAAI;oBACpB,MAAM,KAAK,IAAI,CAAC,IAAI;gBACtB;gBACA,WAAW;YACb,OAAO;gBAEL,MAAM,CAAA,GAAA,iKAAA,CAAA,SAAM,AAAD,EAAE,CAAA,GAAA,iKAAA,CAAA,MAAG,AAAD,EAAE,2HAAA,CAAA,KAAE,EAAE,cAAc,KAAK,EAAE,CAAC,IAAI,KAAK;oBAClD,MAAM,KAAK,IAAI,CAAC,IAAI;oBACpB,MAAM,KAAK,IAAI,CAAC,IAAI;gBACtB;gBACA,WAAW;YACb;YACA,QAAQ;gBAAE,IAAI;gBAAI,MAAM;gBAAI,MAAM;YAAG;YACrC,UAAU;YACV;QACF,EAAE,OAAO,KAAK;YACZ,WAAW;YACX,QAAQ,KAAK,CAAC;QAChB;IACF;IAGA,MAAM,eAAe,OAAO;QAC1B,IAAI,CAAC,QAAQ,yCAAyC;QACtD,MAAM,CAAA,GAAA,iKAAA,CAAA,YAAS,AAAD,EAAE,CAAA,GAAA,iKAAA,CAAA,MAAG,AAAD,EAAE,2HAAA,CAAA,KAAE,EAAE,cAAc;QACtC,WAAW;QACX;IACF;IAGA,MAAM,aAAa,CAAC;QAClB,UAAU,IAAI,EAAE;QAChB,QAAQ;YAAE,IAAI,IAAI,EAAE;YAAE,MAAM,IAAI,IAAI;YAAE,MAAM,IAAI,IAAI,IAAI;QAAG;IAC7D;IAGA,MAAM,eAAe;QACnB,UAAU;QACV,QAAQ;YAAE,IAAI;YAAI,MAAM;YAAI,MAAM;QAAG;IACvC;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAG,WAAU;;sCACZ,8OAAC,8IAAA,CAAA,SAAM;4BAAC,WAAU;;;;;;wBAAkB;;;;;;;gBAErC,yBACC,8OAAC;oBAAI,WAAU;8BACZ;;;;;;8BAGL,8OAAC;oBAAK,UAAU;oBAAc,WAAU;;sCACtC,8OAAC;4BACC,MAAK;4BACL,WAAU;4BACV,aAAY;4BACZ,OAAO,KAAK,EAAE;4BACd,UAAU,CAAA,IAAK,QAAQ;oCAAE,GAAG,IAAI;oCAAE,IAAI,EAAE,MAAM,CAAC,KAAK;gCAAC;;;;;;sCAGvD,8OAAC;4BACC,MAAK;4BACL,WAAU;4BACV,aAAY;4BACZ,OAAO,KAAK,IAAI;4BAChB,UAAU,CAAA,IAAK,QAAQ;oCAAE,GAAG,IAAI;oCAAE,MAAM,EAAE,MAAM,CAAC,KAAK;gCAAC;;;;;;sCAEzD,8OAAC;4BACC,MAAK;4BACL,WAAU;4BACV,aAAY;4BACZ,OAAO,KAAK,IAAI;4BAChB,UAAU,CAAA,IAAK,QAAQ;oCAAE,GAAG,IAAI;oCAAE,MAAM,EAAE,MAAM,CAAC,KAAK;gCAAC;;;;;;sCAEzD,8OAAC;4BACC,MAAK;4BACL,WAAW,CAAC;cACV,EAAE,SAAS,sCAAsC,iCAAiC;;gCAEnF,uBAAS,8OAAC,8IAAA,CAAA,SAAM;;;;yDAAM,8OAAC,8IAAA,CAAA,SAAM;;;;;gCAC7B,SAAS,aAAa;;;;;;;wBAExB,wBACC,8OAAC;4BACC,MAAK;4BACL,WAAU;4BACV,SAAS;;8CAET,8OAAC,8IAAA,CAAA,UAAO;;;;;gCAAG;;;;;;;;;;;;;8BAIjB,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;wBAAM,WAAU;;0CACf,8OAAC;0CACC,cAAA,8OAAC;oCAAG,WAAU;;sDACZ,8OAAC;4CAAG,WAAU;sDAAuB;;;;;;sDACrC,8OAAC;4CAAG,WAAU;sDAAuB;;;;;;sDACrC,8OAAC;4CAAG,WAAU;sDAAuB;;;;;;sDACrC,8OAAC;4CAAG,WAAU;sDAA8B;;;;;;;;;;;;;;;;;0CAGhD,8OAAC;;oCACE,WAAW,GAAG,CAAC,CAAC,kBACf,8OAAC;4CAAc,WAAU;;8DACvB,8OAAC;oDAAG,WAAU;8DAAc,EAAE,EAAE;;;;;;8DAChC,8OAAC;oDAAG,WAAU;8DAAc,EAAE,IAAI;;;;;;8DAClC,8OAAC;oDAAG,WAAU;8DACX,EAAE,IAAI,iBACL,8OAAC;wDAAI,KAAK,EAAE,IAAI;wDAAE,KAAK,EAAE,IAAI;wDAAE,WAAU;;;;;6EAEzC,8OAAC;wDAAK,WAAU;;0EAAwC,8OAAC,8IAAA,CAAA,UAAO;;;;;4DAAG;;;;;;;;;;;;8DAGvE,8OAAC;oDAAG,WAAU;;sEACZ,8OAAC;4DACC,WAAU;4DACV,SAAS,IAAM,WAAW;4DAC1B,OAAM;sEAEN,cAAA,8OAAC,8IAAA,CAAA,SAAM;;;;;;;;;;sEAET,8OAAC;4DACC,WAAU;4DACV,SAAS,IAAM,aAAa,EAAE,EAAE;4DAChC,OAAM;sEAEN,cAAA,8OAAC,8IAAA,CAAA,UAAO;;;;;;;;;;;;;;;;;2CAvBL,EAAE,EAAE;;;;;oCA4Bd,WAAW,MAAM,KAAK,mBACrB,8OAAC;kDACC,cAAA,8OAAC;4CAAG,SAAS;4CAAG,WAAU;sDAAiC;;;;;;;;;;;;;;;;;;;;;;;;;;;;gBAMpE,yBAAW,8OAAC;oBAAI,WAAU;8BAAiC;;;;;;;;;;;;;;;;;AAIpE","debugId":null}}]
}